<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>

<script src="jquery.3.3.1.js" charset="utf-8"></script>
<script src="utilities.js" charset="utf-8"></script>
<script src="data.js" charset="utf-8"></script>
<script src="dataHumanNames.js" charset="utf-8"></script>
<script src="dataPlaces.js" charset="utf-8"></script>
<script src="dataConditioner.js" charset="utf-8"></script>
<script src="dataPicker.js" charset="utf-8"></script>
<script src="dataMason.js" charset="utf-8"></script>
<script src="place.js" charset="utf-8"></script>
<script src="map.js" charset="utf-8"></script>
<!-- WARNING: This map function is ALMOST expendable. The places happen to use it for insertions... -->

<style>
pre {
	font-family: "courier";
	line-height: 0.8;
	font-size:12px;
}
</style>
<script>


	function main() {

		new DataConditioner();

		let palette = {
			floor: TileTypeList.floor.symbol,
			wall:  TileTypeList.wall.symbol,
			door:  TileTypeList.door.symbol,
			fillFloor:  TileTypeList.floor.symbol,
			fillWall:  TileTypeList.wall.symbol,
			outlineWall:  TileTypeList.wall.symbol,
			passageFloor:  TileTypeList.floor.symbol,
			unknown: TILE_UNKNOWN,
		};

		let sideDimension = 40; //Math.randInt(40,150);

		// Floor Density
		// 0.10 - 0.30 - spindly maps. Below 0.10 it is all just passage.
		// 0.40 - 0.50 - lanky, with generally thick passages
		// 0.60 - 0.70 - Pretty chunky rooms
		// 0.80 - 0.90 - Vast open spaces with stone columns intruding
		// Seed Percent
		// Lower number (0.05) means each room is more consolidated
		// Higher number (0.50) means lots of little rooms that connect.
		// floor=0.50, seed 0.02, wanderingPassage false, makes nice connected rooms
		let scape = {
			dim: sideDimension,
			architecture: "cave",
			mustConnect: false,
			wanderingPassage: true,
			floorDensity: 	0.40,
			seedPercent: 	0.20,
			placeDensity: 	0.50			// always relative to floor
		};

		let level = 10;
		let theme = ThemeList.cavern;
		// NOTICE that I am NOT passing the theme's scape, but instead overriding it
		// so that you can tweak it.
		let injectList = [];
		let picker = new Picker(level,theme);
		let map = Mason.buildMap( picker, scape, palette, injectList, map => document.getElementById('map').innerHTML = map );
		if( map ) {
			document.getElementById('map').innerHTML = map.renderToString();
		}
	}
</script>
</head>
<body>
	<pre id='map'></pre>
<script>main();</script>
</body>
</html>
